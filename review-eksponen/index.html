<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <title>Review Eksponen Kelas X</title>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <style>
    body { font-family: Arial, sans-serif; background: #f2f4f7; padding: 20px; }
    .container { max-width: 700px; margin: auto; background: #fff; padding: 25px; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1); text-align: center; }
    h1 { margin-bottom: 10px; }
    .question { font-size: 20px; margin: 20px 0; }
    .options label { display: block; margin: 8px 0; text-align: left; cursor: pointer; }
    button { margin: 15px 5px 0 5px; padding: 10px 16px; font-size: 16px; cursor: pointer; }
    .info { margin-top: 15px; font-size: 16px; font-weight: bold; }
  </style>
</head>
<body>
<div class="container">
  <h1>Review Eksponen Kelas X</h1>
  <div id="progress"></div>
  <div id="quiz"></div>
  <div><button onclick="cekSoal()">Cek Jawaban Soal Ini</button></div>
  <div>
    <button onclick="prevSoal()">Sebelumnya</button>
    <button onclick="nextSoal()">Berikutnya</button>
    <button onclick="selesai()">Selesai</button>
  </div>
  <div class="info" id="feedback"></div>
  <div class="info" id="hasil"></div>
</div>

<script>
// ================= UTIL =================
function randInt(min, max) {
  return Math.floor(Math.random() * (max - min + 1)) + min;
}
function shuffle(arr) {
  return arr.map(v => ({ v, r: Math.random() }))
            .sort((a,b)=>a.r-b.r)
            .map(o=>o.v);
}

// ================= AUTO-GENERATOR (LATEX AMAN) =================
function generateSoal(jumlah = 30) {
  const hasil = [];

  for (let i = 0; i < jumlah; i++) {
    const tipe = randInt(1, 7);
    let tanya = "";
    let benar = "";

    if (tipe === 1) {
      let a = randInt(2,5), m = randInt(2,5), n = randInt(2,5);
      tanya = `${a}^${m} \\times ${a}^${n}`;
      benar = `${a}^${m+n}`;

    } else if (tipe === 2) {
      let a = randInt(2,5), m = randInt(4,7), n = randInt(1,3);
      tanya = `${a}^${m} : ${a}^${n}`;
      benar = `${a}^${m-n}`;

    } else if (tipe === 3) {
      let a = randInt(2,4), m = randInt(2,4), n = randInt(2,3);
      tanya = `(${a}^${m})^${n}`;
      benar = `${a}^${m*n}`;

    } else if (tipe === 4) {
      let a = randInt(2,5), n = randInt(1,2);
      tanya = `${a}^{-${n}}`;
      benar = `\\frac{1}{${a**n}}`;

    } else if (tipe === 5) {
      let a = [4,9,16,25,36][randInt(0,4)];
      if (Math.random() < 0.5) {
        tanya = `${a}^{\\frac{1}{2}}`;
      } else {
        tanya = `\\sqrt{${a}}`;
      }
      benar = `${Math.sqrt(a)}`;

    } else if (tipe === 6) {
      let n = randInt(3,4);
      let base = randInt(2,5);
      let a = base ** n;
      if (Math.random() < 0.5) {
        tanya = `\\sqrt[${n}]{${a}}`;
      } else {
        tanya = `${a}^{\\frac{1}{${n}}}`;
      }
      benar = `${base}`;

    } else if (tipe === 7) {
      const pasangan = [{p:2,q:3},{p:2,q:5},{p:3,q:2}];
      const {p,q} = pasangan[randInt(0, pasangan.length-1)];
      let base = randInt(2,4);
      let a = base ** q;
      tanya = `${a}^{\\frac{${p}}{${q}}}`;
      benar = `${base**p}`;
    }

    const opsi = shuffle([
      benar,
      `${randInt(2,6)}^${randInt(2,5)}`,
      `${randInt(2,20)}`,
      `\\frac{1}{${randInt(2,25)}}`,
      `${randInt(2,6)}^${randInt(1,4)}`
    ]);

    hasil.push({ tanya, opsi, benar: opsi.indexOf(benar) });
  }
  return hasil;
}

const soal = generateSoal(30);

// ================= STATE =================
let index = 0;
let jawaban = Array(soal.length).fill(null);
let statusCek = Array(soal.length).fill(false);

const quiz = document.getElementById("quiz");
const progress = document.getElementById("progress");
const feedback = document.getElementById("feedback");

// ================= RENDER =================
function tampilSoal() {
  const s = soal[index];
  progress.innerHTML = `Soal ${index+1} dari ${soal.length}`;

  let html = `<div class='question'>\\(${s.tanya}\\)</div><div class='options'>`;

  s.opsi.forEach((o,i)=>{
    const cek = jawaban[index]===i?'checked':'';
    let warna = '';
    if (statusCek[index]) {
      if (i===s.benar) warna='style="color:green;font-weight:bold"';
      else if (jawaban[index]===i) warna='style="color:red"';
    }
    html += `<label ${warna}><input type='radio' name='opsi' value='${i}' ${cek}> \\(${o}\\)</label>`;
  });

  html += `</div>`;
  quiz.innerHTML = html;
  MathJax.typesetPromise();
}

// ================= EVENTS =================
quiz.addEventListener('change', e => {
  if (e.target.name==='opsi') jawaban[index]=parseInt(e.target.value);
});

function cekSoal() {
  if (jawaban[index]==null) { alert('Pilih jawaban terlebih dahulu'); return; }
  statusCek[index]=true;
  feedback.innerHTML = jawaban[index]===soal[index].benar
    ? "✅ <span style='color:green'>Jawaban kamu BENAR</span>"
    : "❌ <span style='color:red'>Jawaban kamu SALAH</span>";
  tampilSoal();
}
function nextSoal(){ if(index<soal.length-1){index++; tampilSoal();} }
function prevSoal(){ if(index>0){index--; tampilSoal();} }
function selesai(){
  let skor=0; jawaban.forEach((j,i)=>{if(j===soal[i].benar) skor++;});
  document.getElementById('hasil').innerHTML=`Skor akhir: ${skor} / ${soal.length}`;
}

// ================= INIT =================
tampilSoal();
</script>
</body>
</html>
